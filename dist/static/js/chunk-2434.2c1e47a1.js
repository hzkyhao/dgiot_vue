(this.webpackJsonp=this.webpackJsonp||[]).push([["chunk-2434"],{"3SVy":function(t,e,a){},"3q6/":function(t,e,a){"use strict";a.r(e);var i=a("gDS+"),n=a.n(i),r=a("v0iw"),o=a.n(r),l=a("LIjw"),s={name:"Mainstation",data:function(){return{msg:{bianma:"",time:""},readtime:""}},computed:{},mounted:function(){this.$nextTick(function(){this.nowtime})},methods:{nowtime:function(){var t=Date.parse(new Date),e=new Date(t),a=e.getFullYear()+"年",i=(e.getMonth()+1<=10?"0"+(e.getMonth()+1):e.getMonth()+1)+"月",n=(e.getDate()+1<=10?"0"+e.getDate():e.getDate())+"日  ",r=(e.getHours()+1<=10?"0"+e.getHours():e.getHours())+":",o=(e.getMinutes()+1<=10?"0"+e.getMinutes():e.getMinutes())+":",l=e.getSeconds()+1<=10?"0"+e.getSeconds():e.getSeconds();this.readtime=a+i+n+r+o+l,this.$emit("handback",this.msg)},getinformation:function(){}}},c=(a("J6tw"),a("sCux"),a("KHd+")),d=Object(c.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mainstation"},[a("div",[a("el-row",{attrs:{gutter:32}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple",staticStyle:{position:"relative"}},[a("span",{staticStyle:{"margin-top":"-20px","margin-left":"10px",position:"fixed",top:"-5",left:"10",background:"white"}},[t._v("终端信息")]),t._v(" "),a("div",{staticClass:"outmain"},[a("label",{attrs:{for:""}},[t._v("终端编码：")]),t._v(" "),a("el-input",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"text"},model:{value:t.msg.bianma,callback:function(e){t.$set(t.msg,"bianma",e)},expression:"msg.bianma"}})],1)])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple",staticStyle:{position:"relative"}},[a("span",{staticStyle:{"margin-top":"-20px","margin-left":"10px",position:"fixed",top:"-5",left:"10",background:"white"}},[t._v("系统时间：")]),t._v(" "),a("div",{staticClass:"outmain"},[a("el-input",{staticStyle:{display:"inline-block",width:"300px"},attrs:{type:"text"},model:{value:t.readtime,callback:function(e){t.readtime=e},expression:"readtime"}})],1)])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple",staticStyle:{position:"relative"}},[a("span",{staticStyle:{"margin-top":"-20px","margin-left":"10px",position:"fixed",top:"-5",left:"10",background:"white"}},[t._v("等待应答反馈时间/秒")]),t._v(" "),a("div",{staticClass:"outmain"},[a("el-input",{staticStyle:{display:"inline-block",width:"200px"},attrs:{type:"number"},model:{value:t.msg.time,callback:function(e){t.$set(t.msg,"time",e)},expression:"msg.time"}})],1)])])],1)],1)])},[],!1,null,"77a917a9",null);d.options.__file="index.vue";d.exports;var m=a("gHYM"),p=a("xiB2"),u=a("6y/i"),f=a("fe1z"),h=(a("S+eF"),a("p46w"),{components:{Resource1:m.a},data:function(){var t=this;this.$createElement;return{value1:"",datatimetype:"datetime",operatetype:[],isSelecttime:!0,isCollapse:!0,data1:[],value:[],renderFunc:function(t,e){return t("span",[e.label])},currentPage:1,total:20,pageSize:10,activeName:"second",formInline:{protocol:"30",user:"",vcaddr:"",datatype:"",operation:"",start:"1",end:"1",jiange:"",starttime:"",endtime:"",route:"tcp"},pickerBeginDateBefore:{disabledDate:function(e){return t.formInline.endtime?e.getTime()>new Date(t.formInline.endtime).getTime():e.getTime()>Date.now()-864e4}},pickerBeginDateAfter:{disabledDate:function(e){return t.formInline.starttime?e.getTime()>Date.now()||e.getTime()<new Date(t.formInline.starttime).getTime():e.getTime()>Date.now()-864e4}},operation:"",datatype:[],dialogTableVisible:!1,radio:3,data:[],defaultProps:{children:"children",label:"name",isLeaf:"leaf"},tableData1:[],searchvalue:"",departmentid:"",userForm:{usertype:"",searchtype:"",userhh:"",username:"",zdjh:"",ljdz:""},selectdata:[],session:"",data2:{},originrecivedata:[],gridData1:[]}},computed:{treeData:function(){var t=JSON.parse(n()(this.data));return t.filter(function(e){var a=t.filter(function(t){return e.objectId==t.ParentId});return a.length>0&&(e.children=a),a.length>0&&(e.leaf=!0),0==e.ParentId})}},mounted:function(){this.getOperate(),this.session=sessionStorage.getItem("token"),console.log(this.datatype)},methods:{protocolChange:function(t){20==t&&this.formInline.operation!=this.operatetype[3].id?(this.datatimetype="date",this.formInline.operation=this.operatetype[2].id,this.firstchange(this.operatetype[2].id)):20==t&&this.formInline.operation==this.operatetype[3].id?(this.datatimetype="month",this.formInline.starttime=new Date-2592e6,this.firstchange(this.operatetype[3].id)):(this.datatimetype="datetime",this.formInline.operation=this.operatetype[1].id,this.firstchange(this.operatetype[1].id))},getOperate:function(){var t=this,e=o.a.Object.extend("MainStationIndex"),a=new o.a.Query(e);a.startsWith("name","C."),a.ascending("name"),a.find().then(function(e){t.operatetype=e,t.formInline.operation=e[1].id,t.firstchange(e[1].id)})},handleClick:function(){},handleClose:function(){this.dialogTableVisible=!1},firstchange:function(t){var e=this;this.formInline.datatype="",this.datatype=[];var a=o.a.Object.extend("MainStationIndex"),i=new o.a.Query(a);i.equalTo("objectId",t),i.find().then(function(t){t.map(function(t){t.attributes.leafs.map(function(a){var i={label:a,modelindex:t.attributes.sendtype,key:a};e.datatype.push(i)}),e.formInline.datatype=e.datatype[0].key,e.dataselect(e.datatype[0].key)})}),20==this.formInline.protocol&&this.formInline.operation!=this.operatetype[3].id?this.datatimetype="date":20==this.formInline.protocol&&this.formInline.operation==this.operatetype[3].id?(this.datatimetype="month",this.formInline.starttime=new Date-2592e6):this.datatimetype="datetime"},getcheck:function(t,e){this.getMainstation(t.objectId)},test:function(){this.formInline={protocol:"30",user:"",vcaddr:"",datatype:"",operation:"",start:"1",end:"1",jiange:"",starttime:new Date,endtime:new Date,route:"tcp"},this.getOperate()},getValue:function(){var t=this;if(console.log(this.value1),this.gridData1.length=0,0==this.selectdata.length)this.$message({type:"warning",message:"请选择数据项标识"});else if(0==p.a.connState)this.$message({type:"warning",message:"正在重新连接，请稍后"});else if(""==this.formInline.vcaddr)this.$message({type:"warning",message:"请挑选集中器或电表"});else{var e=this;p.a.originrecivedata=[];var a=Math.ceil(25*Math.random()),i=String.fromCharCode(65+a)+Math.ceil(1e5*Math.random());u.a.$on(i,function(t){e.gridData1=[],t.data.map(function(a){p.b.map(function(i){a.di==i.key&&e.gridData1.unshift({di:a.di,pn:a.pn,value:n()(a.value),vcaddr:t.vcaddr,ts:Object(f.n)(a.ts),meteraddr:a.meteraddr,diname:i.label,time:a.time,status:a.status})})}),console.log(e.gridData1)}),this.formInline.route="tcp",Object(l.b)(this.formInline.vcaddr,this.session,i,this.operation,this.formInline.start,this.formInline.end,Math.ceil(this.formInline.starttime/1e3),Math.ceil(this.formInline.endtime/1e3),this.formInline.route,this.formInline.protocol,this.selectdata).then(function(e){e&&(t.dialogTableVisible=!0)}).catch(function(e){t.$message({type:"error",message:e.error})})}},handleChange:function(t){this.selectdata=t},meterdetail:function(t){var e=this;if("集中器"!=t.icon&&"电表"!=t.icon)this.$message({type:"warning",message:"请挑选集中器或电表"});else if("集中器"==t.icon)this.formInline.vcaddr=t.alias,this.formInline.start=1,this.formInline.end=1;else if("电表"==t.icon){var a=o.a.Object.extend("Smartmeter");new o.a.Query(a).get(t.objectId).then(function(t){e.formInline.vcaddr=t.attributes.vcaddr_web,e.formInline.start=t.attributes.pn,e.formInline.end=t.attributes.pn},function(t){e.$message({type:"error",message:t.error})})}},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t},handleCurrentChange:function(t){this.currentPage=t},getMainstation:function(t){var e=this;this.session=o.a.User.current().attributes.sessionToken;var a=o.a.Object.extend("Department"),i=new o.a.Query(a);i.equalTo("ParentId",t),i.limit(1e4),i.find().then(function(t){t.map(function(t){var a={};t.createtime=new Date(t.attributes.createdAt).toLocaleDateString(),a.name=t.attributes.name,a.ParentId=t.attributes.ParentId,a.objectId=t.id,a.level=t.attributes.level,a.createtime=t.createtime,a.alias=t.attributes.alias,a.leaf=t.attributes.leafnode,a.icon=t.attributes.org_type,e.data.push(a)})},function(t){"209"==t.code?(e.$message({type:"warning",message:"登陆权限过期，请重新登录"}),e.$router.push({path:"/login"})):e.$message.error(t.message)})},dataselect:function(t){var e=this;if(p.b.length=0,this.value=[],this.data1=[],this.datatype.map(function(a){t==a.label&&(e.operation=a.modelindex)}),30==this.formInline.protocol){var a=o.a.Object.extend("DataItem"),i=new o.a.Query(a);i.equalTo("leafname",t),i.limit(1e3),i.ascending("itemCode"),i.find().then(function(t){t.map(function(t){var a={label:t.attributes.itemName,key:t.attributes.itemCode};e.data1.push(a),p.b.push(a)})})}else{var n=o.a.Object.extend("DataItemGW"),r=new o.a.Query(n);r.equalTo("leafname",t),r.limit(1e3),r.ascending("itemCode"),r.find().then(function(t){t.map(function(t){var a={label:t.attributes.itemName,key:t.attributes.itemCode};e.data1.push(a),p.b.push(a)})})}"c.3"==this.operation||"c.4"==this.operation?(this.isSelecttime=!1,this.formInline.starttime=new Date((new Date).setHours(0,0,0,0)-864e5),this.formInline.endtime=new Date):"c.2"==this.operation&&(this.isSelecttime=!0,this.formInline.endtime=(new Date).getTime(),this.formInline.starttime=this.formInline.endtime-2538e5)}}}),g=(a("Gw6L"),a("KwR0"),a("VF55"),Object(c.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mainstations"},[a("Resource1",{staticStyle:{width:"360px",height:"100vh",overflow:"scroll","flex-shrink":"0",padding:"10px"},on:{meterdetail:t.meterdetail}}),t._v(" "),"second"==t.activeName?a("div",{staticClass:"secondcard",staticStyle:{"min-height":"875px","border-left":"2px solid #156FAE",background:"#f6fbff"}},[a("div",{staticStyle:{width:"100%",height:"auto",padding:"20px","box-sizing":"border-box"}},[a("div",{staticClass:"blockcontent"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"操作类型:"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"操作类型"},on:{change:t.firstchange},model:{value:t.formInline.operation,callback:function(e){t.$set(t.formInline,"operation",e)},expression:"formInline.operation"}},t._l(t.operatetype,function(t,e){return a("el-option",{key:e,attrs:{label:t.attributes.webtype,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"数据类型:"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"数据类型"},on:{change:t.dataselect},model:{value:t.formInline.datatype,callback:function(e){t.$set(t.formInline,"datatype",e)},expression:"formInline.datatype"}},t._l(t.datatype,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.key}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"终端逻辑地址:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"终端逻辑地址"},model:{value:t.formInline.vcaddr,callback:function(e){t.$set(t.formInline,"vcaddr",e)},expression:"formInline.vcaddr"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规约名称:"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"规约类型"},on:{change:t.protocolChange},model:{value:t.formInline.protocol,callback:function(e){t.$set(t.formInline,"protocol",e)},expression:"formInline.protocol"}},[a("el-option",{attrs:{label:"南网上行通信规约",value:"30"}}),t._v(" "),a("el-option",{attrs:{label:"国网通信规约",value:"20"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"通道类型:"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"数据类型"},model:{value:t.formInline.route,callback:function(e){t.$set(t.formInline,"route",e)},expression:"formInline.route"}},[a("el-option",{attrs:{label:"默认",value:"tcp"}}),t._v(" "),a("el-option",{attrs:{label:"无线",value:"tcp1"}}),t._v(" "),a("el-option",{attrs:{label:"载波",value:"tcp2"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"开始测量点号:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"开始测量点号",type:"number",min:1,max:2048},model:{value:t.formInline.start,callback:function(e){t.$set(t.formInline,"start",e)},expression:"formInline.start"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束测量点号:"}},[a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"结束测量点号",type:"number",min:1,max:2048},model:{value:t.formInline.end,callback:function(e){t.$set(t.formInline,"end",e)},expression:"formInline.end"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间:"}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:t.datatimetype,placeholder:"选择开始时间","value-format":"timestamp","picker-options":t.pickerBeginDateBefore},model:{value:t.formInline.starttime,callback:function(e){t.$set(t.formInline,"starttime",e)},expression:"formInline.starttime"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间:"}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:t.datatimetype,placeholder:"选择结束时间","value-format":"timestamp","picker-options":t.pickerBeginDateAfter},model:{value:t.formInline.endtime,callback:function(e){t.$set(t.formInline,"endtime",e)},expression:"formInline.endtime"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"blockfooter"},[a("el-button",{attrs:{type:"primary"},on:{click:t.getValue}},[t._v("召测")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.test}},[t._v("重置")])],1),t._v(" "),a("div",{staticStyle:{height:"8px",width:"100%",background:"#ffffff"}}),t._v(" "),a("div",{staticClass:"blockall",staticStyle:{"text-align":"center",height:"auto"}},[a("el-transfer",{staticStyle:{"text-align":"left",display:"inline-block","margin-top":"20px"},attrs:{"render-content":t.renderFunc,titles:["数据标识DI","选定查询数据项"],"button-texts":["删除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:t.data1},on:{change:t.handleChange},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)])]):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"召测数据",visible:t.dialogTableVisible,"close-on-click-modal":!1,"before-close":t.handleClose,width:"82%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.gridData1.slice((t.currentPage-1)*t.pageSize,t.currentPage*t.pageSize),height:"400"}},[a("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"vcaddr",label:"终端逻辑地址",width:"120",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"pn",label:"测量点号",width:"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"meteraddr",label:"电表地址",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"diname",label:"数据项标识",width:"250",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"value",label:"数据",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"冻结日期",align:"center","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.time?a("span",[8==e.row.time.length?a("span",[t._v(t._s(e.row.time.toString().substring(0,4)+"-"+e.row.time.toString().substring(4,6)+"-"+e.row.time.toString().substring(6,8)))]):a("span",[t._v(t._s(e.row.time.toString().substring(0,4)+"-"+e.row.time.toString().substring(4,6)))])]):a("span")]}}])}),t._v(" "),a("el-table-column",{attrs:{property:"ts",label:"时间",width:"200",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticStyle:{color:"green"}},[t._v("完成")]):0==e.row.status?a("span",{staticStyle:{color:"green"}},[t._v("召测中")]):3==e.row.status?a("span",{staticStyle:{color:"red"}},[t._v("无档案")]):a("span",{staticStyle:{color:"red"}},[t._v("超时")])]}}])})],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-top":"15px"}},[a("el-pagination",{attrs:{align:"center","current-page":t.currentPage,"page-sizes":[1,5,10,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.gridData1.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)},[],!1,null,"099646c2",null));g.options.__file="jia.vue";e.default=g.exports},"8Utz":function(t,e,a){},Gw6L:function(t,e,a){"use strict";var i=a("nkv8");a.n(i).a},J6tw:function(t,e,a){"use strict";var i=a("3SVy");a.n(i).a},KwR0:function(t,e,a){"use strict";var i=a("zKm6");a.n(i).a},LIjw:function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"a",function(){return r});var i=a("t3Un");function n(t,e,a,n,r,o,l,s,c,d,m){return Object(i.a)({url:"/readdata",method:"POST",params:{from:"web",vcaddr:t,session:e,operation:a,datatype:n,pn_start:r,pn_end:o,starttime:l,endtime:s,route:c,protocol:d},data:{dis:m}})}function r(t,e,a,n){return Object(i.a)({url:"/measured_point/control",method:"POST",params:{vcaddr:t.vcaddr,from:"web",session:e,operation:a,control:n,datatype:t.datatype,protocol:t.protocol,route:t.route,pn:t.pn,meteraddr:t.meteraddr}})}},"RU/L":function(t,e,a){a("Rqdy");var i=a("WEpk").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},Rqdy:function(t,e,a){var i=a("Y7ZC");i(i.S+i.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(t,e,a){t.exports={default:a("RU/L"),__esModule:!0}},VF55:function(t,e,a){"use strict";var i=a("n3He");a.n(i).a},YEIV:function(t,e,a){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(a("SEkw"));e.default=function(t,e,a){return e in t?(0,i.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},n3He:function(t,e,a){},nkv8:function(t,e,a){},sCux:function(t,e,a){"use strict";var i=a("8Utz");a.n(i).a},zKm6:function(t,e,a){}}]);