(this.webpackJsonp=this.webpackJsonp||[]).push([["chunk-5610"],{"+JPL":function(e,t,i){e.exports={default:i("+SFK"),__esModule:!0}},"+SFK":function(e,t,i){i("AUvm"),i("wgeU"),i("adOz"),i("dl0q"),e.exports=i("WEpk").Symbol},"/eyY":function(e,t,i){"use strict";i.r(t);var n,a,s=i("v0iw"),o=i.n(s),r=i("S+eF"),c=i("p46w"),l=i.n(c),d=i("XINx"),u=(i("vQy8"),i("7Qib"),i("MPjy")),p={components:{elDragDialog:d.a},data:function(){return{productimg:"",bmapdialogVisible:!1,onlineall:"",activeall:"",userId:"",batchid:"",pcdialogVisible:!1,devicedialogVisible:!1,equvalue:"0",cities:[],activeName:"first",selectdevice:"",deviceinput:"",devicenumber:"",multipleTable:[],selectRow:[],devicelength:10,devicestart:0,devicetotal:0,visible2:!1,deviceform:{name:"",devaddr:"",batchId:"",desc:"",nodeType:0,devType:"",netType:"",assetNum:"",devModel:"",address:"",productName:"",status:"",isEnable:""},rules:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],devaddr:[{required:!0,message:"请输入设备编号",trigger:"blur"}],batchId:[{required:!0,message:"请输入设备批次",trigger:"blur"}],nodeType:[{required:!0,message:"请输入设备类型",trigger:"blur"}],netType:[{required:!0,message:"请选择网络格式",trigger:"change"}],devType:[{required:!0,message:"请选择设备类型",trigger:"change"}],productName:[{required:!0,message:"请选择产品名称",trigger:"change"}]},pcformInline:{pcnumber:"",pcname:"",createdtime:""},pctableData:[],equipmentEditor:"添加",tableData:[],options:[],proTableData:[],proTableData1:[],activelength:[],onlinelength:[],center:{lng:0,lat:0},zoom:13,bmapform:{keyword:"",location:"",address:""},deviceid:"",map:null,addresspointer:"",productenable:!0,changeproduct:!0}},watch:{multipleTable:function(e){var t=this;this.selectRow=[],e.length>0&&e.forEach(function(e,i){t.selectRow.push(t.tableData.indexOf(e))})}},mounted:function(){this.userId=o.a.User.current().id,this.getRole(),this.searchProduct(),this.addDeviceBatch(0),n=l.a.get("language"),this.$store.dispatch("getUserId","111"),this.$route.query.productid&&this.selectProductid(this.$route.query.productid)},methods:{goEdit:function(e){window.open(window.location.origin+"/spa/#/fullscreen?devaddr="+e.devaddr+"&productid="+e.productid,"_blank")},selectProductid:function(e){var t=this,i=o.a.Object.extend("Product");new o.a.Query(i).get(e).then(function(e){t.productimg=e.attributes.icon},function(e){Object(u.a)(e)})},addressSure:function(){var e=new BMap.LocalSearch(this.map);e.enableAutoViewport();e.search(this.bmapform.keyword),this.bmapdialogVisible=!1},handler:function(e){var t=e.BMap,i=e.map;this.center.lng=120.2,this.center.lat=30.26667,this.zoom=this.zoom,this.map=i,console.log(t,i)},mapClick:function(e){var t=this;this.center.lng=e.point.lng,this.center.lat=e.point.lat,this.addresspointer=e.point.lng.toFixed(6)+","+e.point.lat.toFixed(6),(new BMap.Geocoder).getLocation(e.point,function(e){t.bmapform.address=e.address,t.deviceform.address=e.address})},updateLocation:function(){this.bmapdialogVisible=!0},handleClosebmap:function(){this.bmapdialogVisible=!1},getActiveDevices:function(){var e=this,t=o.a.Object.extend("Devices"),i=new o.a.Query(t);i.equalTo("status","ACTIVE"),""!=this.deviceinput&&("设备名称"==this.selectdevice||"Device Name"==this.selectdevice?i.equalTo("name",this.deviceinput):i.equalTo("devaddr",this.deviceinput)),""!=this.devicenumber&&i.equalTo("devaddr",this.devicenumber),0!=this.equvalue&&i.equalTo("product",this.equvalue),i.count().then(function(t){e.activeall=t},function(e){Object(u.a)(e)})},getOnlineDevices:function(){var e=this,t=o.a.Object.extend("Devices"),i=new o.a.Query(t);i.equalTo("status","ONLINE"),""!=this.deviceinput&&("设备名称"==this.selectdevice?i.equalTo("name",this.deviceinput):i.equalTo("devaddr",this.deviceinput)),""!=this.devicenumber&&i.equalTo("devaddr",this.devicenumber),0!=this.equvalue&&i.equalTo("product",this.equvalue),i.count().then(function(t){e.onlineall=t},function(e){Object(u.a)(e)})},searchProduct:function(){var e=this;this.proTableData=[],this.proTableData1=[];var t=o.a.Object.extend("Product"),i=new o.a.Query(t);i.limit(1e4),i.find().then(function(t){t.map(function(t){var i={};i.id=t.id,i.name=t.attributes.name,e.proTableData.push(i),e.proTableData1.push(i)}),e.proTableData.unshift({name:"zh"==n?"全部产品":"All Products",id:"0"}),e.$route.query.productid&&(e.equvalue=e.$route.query.productid,e.productenable=!1),e.getDevices()},function(e){Object(u.a)(e)})},getDevices:function(e){var t=this;0==e&&(this.devicestart=0),this.tableData=[];var i=o.a.Object.extend("Devices"),n=new o.a.Query(i);""!=this.deviceinput&&("设备名称"==this.selectdevice?n.equalTo("name",this.deviceinput):n.equalTo("devaddr",this.deviceinput)),""!=this.devicenumber&&n.equalTo("devaddr",this.devicenumber),0!=this.equvalue&&n.equalTo("product",this.equvalue),n.limit(this.devicelength),n.skip(this.devicestart),n.ascending("-updatedAt"),n.count().then(function(e){t.devicetotal=e,n.find().then(function(e){e&&(e.map(function(e){var i={};i.id=e.id,i.name=e.attributes.name,i.lastOnlineTime=e.attributes.lastOnlineTime,i.status=e.attributes.status,i.originstatus=e.attributes.status,i.nodeType=e.attributes.product.attributes.nodeType,i.desc=e.attributes.desc,i.productName=e.attributes.product.attributes.name,i.devaddr=e.attributes.devaddr,i.isEnable=e.attributes.isEnable,i.productid=e.attributes.product.id,i.devModel=e.attributes.devModel,i.brand=e.attributes.brand,i.address=e.attributes.address,i.assetNum=e.attributes.assetNum,i.createdAt=e.createdAt,i.productid=e.attributes.product.id,e.attributes.location?(i.latitude=e.attributes.location._latitude,i.longitude=e.attributes.location._longitude):(i.latitude="",i.longitude=""),e.attributes.batchId?i.batchid=e.attributes.batchId.id:i.batchid="",i.address=e.attributes.address,t.tableData.push(i)}),t.getActiveDevices(),t.getOnlineDevices())})},function(e){Object(u.a)(e)})},handelUpdate:function(e,t,i){var n=this,a={};for(var s in t)a[s]=t[s];a.isEnable=1!=a.isEnable,this.tableData[i]=a,this.$confirm("是否修改此设备状态?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={};for(var i in t)e[i]=t[i];e.isEnable=1==e.isEnable;var a=o.a.Object.extend("Devices");new o.a.Query(a).get(t.id).then(function(t){t.set("isEnable",e.isEnable),t.save().then(function(e){n.$message({type:"success",message:"状态修改成功"})}),n.getDevices()},function(e){Object(u.a)(e)})}).catch(function(){n.$message({type:"info",message:"已取消修改"});var e=t;e.isEnable=1!=e.isEnable,n.tableData[i]=e})},timestampToTime:function(e){var t=new Date(1e3*e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()+1<=10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds())},getRole:function(){var e=this;this.options=[];var t=o.a.Object.extend("_Role");new o.a.Query(t).find().then(function(t){t.map(function(t){var i={};i.objectId=t.id,i.alias=t.attributes.alias,i.name=t.attributes.name,e.options.push(i)})},function(e){Object(u.a)(e)})},utc2beijing:function(e){return new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},filterTag:function(e,t){return t.tag===e},handleSelectionChange:function(e){this.multipleTable=e,console.log(this.multipleTable)},deleteDevcie:function(e){var t=this;r.Promise.all([this.multipleTable.map(function(e){var t=o.a.Object.extend("Devices");new o.a.Query(t).get(e.id).then(function(e){e.destroy().then(function(e){})})})]).then(function(e){0!=e.length?(t.$message({message:"删除成功",type:"success"}),t.getDevices()):t.$message({message:"删除失败",type:"error"})}).catch(function(e){console.log(e)})},unactiveDevice:function(e){var t=this;r.Promise.all([this.multipleTable.map(function(e){var t=new(o.a.Object.extend("Devices"));t.id=e.id,t.set("isEnable",!1),t.save().then(function(e){})})]).then(function(e){e&&0!=e.length?(t.$message({message:"禁用成功",type:"success"}),t.getDevices()):t.$message({message:"禁用失败",type:"error"})}).catch(function(e){console.log(e)})},activeDevice:function(e){var t=this;r.Promise.all([this.multipleTable.map(function(e){var t=new(o.a.Object.extend("Devices"));t.id=e.id,t.set("isEnable",!0),t.save().then(function(e){})})]).then(function(e){e&&0!=e.length?(t.$message({message:"启用成功",type:"success"}),t.getDevices()):t.$message({message:"启用失败",type:"error"})}).catch(function(e){console.log(e)})},rowClass:function(e){e.row;var t=e.rowIndex;if(this.selectRow.includes(t))return console.log(t),{"background-color":"rgba(185, 221, 249, 0.3)"}},deviceSizeChange:function(e){this.devicelength=e,this.getDevices()},deviceCurrentChange:function(e){this.devicestart=(e-1)*this.devicelength,this.getDevices()},handleClose:function(){this.devicedialogVisible=!1,this.equipmentEditor="添加"},addDeviceForm:function(){this.devicedialogVisible=!0,this.equipmentEditor="添加",this.$route.query.productid?this.deviceform.productName=this.$route.query.productid:0!=this.equvalue?(this.changeproduct=!1,this.deviceform.productName=this.equvalue):this.deviceform.productName=""},handleClose1:function(){this.pcdialogVisible=!1,this.batchid="",this.pcformInline={pcname:"",createdtime:""}},makeSure:function(e){var t=this,i=o.a.Object.extend("Devices");new o.a.Query(i).get(e.row.id).then(function(i){i.destroy().then(function(i){i&&(t.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-"+e.$index].doClose(),t.getDevices())},function(e){Object(u.a)(e)})})},addDeviceBatch:function(e){var t=this;this.pcdialogVisible=0!=e;var i=o.a.Object.extend("Datas"),n=new o.a.Query(i);n.equalTo("type","batch_number"),n.ascending("-createdAt"),n.find().then(function(e){e&&(t.pctableData=e,a=e)},function(e){Object(u.a)(e)})},editorDevice:function(e){var t=this;this.deviceid=e.id,this.devicedialogVisible=!0,this.deviceform.devaddr=e.devaddr,this.deviceform.name=e.name,this.deviceform.assetNum=e.assetNum,this.deviceform.devModel=e.devModel,this.deviceform.desc=e.desc,this.deviceform.productid=e.productid,this.deviceform.brand=e.brand,this.deviceform.productName=e.productid,this.deviceform.batchId=e.batchid,this.deviceform.status=e.status,this.deviceform.isEnable=e.isEnable,this.bmapform.address=e.address,this.batchid=e.batchid,this.center.lat=e.latitude,this.center.lng=e.longitude,this.addresspointer=e.latitude+","+e.longitude,this.deviceform.address=e.address,this.equipmentEditor="编辑",this.getBatch().then(function(i){t.pctableData.map(function(i){(i.id=e.batchid)&&(t.deviceform.batchId=i.attributes.data.batch_name)})}).catch(function(e){console.log(e)})},getBatch:function(){return new r.Promise(function(e,t){a.length>0?e(a):t(!1)})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({type:"error",message:"请按照要求填写参数"}),!1;var i=new(o.a.Object.extend("Devices")),n=new(o.a.Object.extend("Product")),a=new(o.a.Object.extend("Datas")),s=new o.a.ACL;""!=t.deviceid?(i.id=t.deviceid,i.set("status",t.deviceform.status),i.set("isEnable",t.deviceform.isEnable)):(i.set("status","OFFLINE"),i.set("isEnable",!1));var r=new o.a.GeoPoint({latitude:t.center.lat,longitude:t.center.lng});a.id=t.batchid,n.id=t.deviceform.productName,i.set("product",n),i.set("batchId",a),s.setReadAccess(t.userId,!0),s.setWriteAccess(t.userId,!0),i.set("ACL",s),i.set("devaddr",t.deviceform.devaddr),i.set("name",t.deviceform.name),i.set("assetNum",t.deviceform.assetNum),i.set("devModel",t.deviceform.devModel),i.set("brand",t.deviceform.brand),i.set("location",r),i.set("address",t.bmapform.address),i.set("desc",t.deviceform.desc),i.save().then(function(e){e&&(t.$message({type:"success",message:""!=t.deviceid?"编辑成功":"添加成功"}),t.devicedialogVisible=!1,t.equipmentEditor="添加",t.batchid="",t.getDevices(),t.deviceid="",t.$refs.deviceform.resetFields(),t.deviceform.assetNum="",t.deviceform.devModel="",t.deviceform.address="",t.deviceform.desc="",t.deviceform.brand="")},function(e){Object(u.a)(e)})})},addbatch:function(){var e=this;if(""==this.batchid){var t=new(n=o.a.Object.extend("Datas")),i=new o.a.ACL;t.set("data",{batch_name:this.pcformInline.pcname,createdtime:Math.ceil(this.pcformInline.createdtime/1e3)}),t.set("type","batch_number"),i.setReadAccess(this.userId,!0),i.setWriteAccess(this.userId,!0),t.set("ACL",i),t.save().then(function(t){e.$message({message:"新增成功",type:"success"}),e.addDeviceBatch()},function(e){Object(u.a)(e)})}else{var n=o.a.Object.extend("Datas");(t=new o.a.Query(n)).get(this.batchid).then(function(t){t.set("data",{batch_name:e.pcformInline.pcname,createdtime:Math.ceil(e.pcformInline.createdtime/1e3)}),t.save().then(function(t){t&&(e.$message({message:"修改成功",type:"success"}),e.batchid="",e.pcformInline={pcname:"",createdtime:""},e.addDeviceBatch())},function(e){Object(u.a)(e)})})}},updatebatch:function(e,t){this.pcformInline.pcname=e.attributes.data.batch_name,this.pcformInline.createdtime=1e3*e.attributes.data.createdtime,this.batchid=t},deletebatch:function(e){var t=this,i=o.a.Object.extend("Datas");new o.a.Query(i).get(e).then(function(e){e.destroy().then(function(e){e&&(t.$message({type:"success",message:"删除成功"}),t.addDeviceBatch())},function(e){Object(u.a)(e)})})},selectbatch:function(e,t){this.batchid=t,this.deviceform.pc=e.attributes.data.batch_name,this.deviceform.batchId=e.attributes.data.batch_name,this.pcdialogVisible=!1},deviceToDetail:function(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.id,nodeType:e.nodeType,ischildren:!1}})},handleClick:function(e,t){var i=this;if("second"==e.name){var n=o.a.Object.extend("Datas"),a=new o.a.Query(n);a.equalTo("type","batch_number"),a.ascending("-createdAt"),a.find().then(function(e){e&&(i.pctableData=e)},function(e){Object(u.a)(e)})}},deviceToChildren:function(e){this.$router.push({path:"/roles/editdevices",query:{deviceid:e.id,nodeType:e.nodeType,ischildren:!0}})}}},m=(i("GoGi"),i("SKMb"),i("KHd+")),v=Object(m.a)(p,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"equipment"},[i("h3",{staticStyle:{margin:"0"}},[e._v(e._s(e.$t("equipment.equipmentstatistics")))]),e._v(" "),i("div",{staticClass:"equ_header"},[i("ul",[i("li",[i("p",[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"devicelist"}})],1),e._v("\n          "+e._s(e.$t("equipment.totalequipment"))+"\n          "),i("el-tooltip",{attrs:{content:e.$t("equipment.totalequipment"),placement:"top"}},[i("i",{staticClass:"el-icon-question"})])],1),e._v(" "),i("span",[e._v(e._s(e.devicetotal))])]),e._v(" "),i("li",[i("p",[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"shuliang"}})],1),e._v(e._s(e.$t("equipment.activationdevice"))+"\n          "),i("el-tooltip",{attrs:{content:e.$t("equipment.totalactive"),placement:"top"}},[i("i",{staticClass:"el-icon-question"})])],1),e._v(" "),i("span",[e._v(e._s(e.activeall))])]),e._v(" "),i("li",[i("p",[i("span",{staticClass:"svg-container"},[i("svg-icon",{attrs:{"icon-class":"onlinelist"}})],1),e._v(e._s(e.$t("equipment.onlinedevices"))+"\n          "),i("el-tooltip",{attrs:{content:e.$t("equipment.totalonline"),placement:"top"}},[i("i",{staticClass:"el-icon-question"})])],1),e._v(" "),i("span",[e._v(e._s(e.onlineall))])]),e._v(" "),i("li",[i("div",{staticClass:"block"},[e.productimg?i("el-image",{staticStyle:{width:"250px",height:"200px",position:"relative",top:"-55px","text-align":"center","line-height":"200px"},attrs:{src:e.productimg}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]):e._e()],1)])])]),e._v(" "),i("div",{staticClass:"equtabs"},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:e.$t("route.设备管理"),name:"first"}},[i("div",[i("div",[i("el-button",{attrs:{size:"small"}},[e._v(e._s(e.$t("equipment.batchaddition")))]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addDeviceForm}},[e._v(e._s(e.$t("equipment.adddevice")))])],1)]),e._v(" "),i("div",{staticClass:"equdevices",staticStyle:{"margin-top":"20px"}},[i("el-select",{staticClass:"selectdetail",attrs:{size:"small",disabled:!e.productenable},on:{change:e.selectProductid},model:{value:e.equvalue,callback:function(t){e.equvalue=t},expression:"equvalue"}},e._l(e.proTableData,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),e._v(" "),i("el-select",{staticClass:"selectdetail",attrs:{size:"small"},model:{value:e.selectdevice,callback:function(t){e.selectdevice=t},expression:"selectdevice"}},[i("el-option",{attrs:{value:e.$t("equipment.devicename")}}),e._v(" "),i("el-option",{attrs:{value:e.$t("equipment.devicenumber")}})],1),e._v(" "),e.selectdevice==e.$t("equipment.devicename")?i("el-input",{staticClass:"selectdetail",attrs:{size:"small",placeholder:e.$t("equipment.enterproductname")},model:{value:e.deviceinput,callback:function(t){e.deviceinput=t},expression:"deviceinput"}}):i("el-input",{staticClass:"selectdetail",attrs:{size:"small",placeholder:e.$t("equipment.enterdevicenumber")},model:{value:e.deviceinput,callback:function(t){e.deviceinput=t},expression:"deviceinput"}}),e._v(" "),i("el-button",{staticClass:"selectdetail",attrs:{size:"small",type:"primary"},on:{click:function(t){e.getDevices(0)}}},[e._v(e._s(e.$t("developer.search")))]),e._v(" "),i("el-button",{staticClass:"selectdetail",attrs:{size:"small",type:"primary",disabled:0==e.multipleTable.length},on:{click:e.deleteDevcie}},[e._v(e._s(e.$t("developer.delete")))]),e._v(" "),i("el-button",{staticClass:"selectdetail",attrs:{size:"small",type:"primary",disabled:0==e.multipleTable.length},on:{click:e.unactiveDevice}},[e._v(e._s(e.$t("developer.prohibit")))]),e._v(" "),i("el-button",{staticClass:"selectdetail",attrs:{size:"small",type:"primary",disabled:0==e.multipleTable.length},on:{click:e.activeDevice}},[e._v(e._s(e.$t("developer.enable")))])],1),e._v(" "),i("div",{staticClass:"tabstable"},[i("el-table",{ref:"filterTable",staticStyle:{width:"100%","text-align":"center","margin-top":"20px"},attrs:{data:e.tableData,"row-style":e.rowClass},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.devicenumber")+"/"+e.$t("equipment.name"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.devaddr))]),e._v(" "),i("p",{staticStyle:{margin:"0",color:"green"}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.state"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"ACTIVE"},[e._v("已注册")]),i("el-tooltip",{attrs:{content:"设备已注册",placement:"top"}},[i("i",{staticClass:"el-icon-question"})])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.product"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{attrs:{type:"success"}},[e._v(e._s(t.row.productName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.nodetype"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[0==e.row.nodeType?i("svg-icon",{staticStyle:{width:"2rem",height:"2rem"},attrs:{"icon-class":"iot"}}):i("svg-icon",{staticStyle:{width:"2rem",height:"2rem"},attrs:{"icon-class":"wgicon"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("developer.enable")+"/"+e.$t("developer.prohibit"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{"active-color":"#5eb058","inactive-color":"#cccccc"},on:{change:function(i){e.handelUpdate(i,t.row,t.$index)}},model:{value:t.row.isEnable,callback:function(i){e.$set(t.row,"isEnable",i)},expression:"scope.row.isEnable"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.utc2beijing(t.row.createdAt)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("developer.operation"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-view"},on:{click:function(i){e.deviceToDetail(t.row)}}},[e._v(e._s(e.$t("equipment.see")))]),e._v(" "),i("el-popover",{ref:"popover-"+t.$index,attrs:{placement:"top",width:"300"}},[i("p",[e._v("确定删除这个"+e._s(t.row.name)+"设备吗？")]),e._v(" "),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v(e._s(e.$t("developer.cancel")))]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.makeSure(t)}}},[e._v(e._s(e.$t("developer.determine")))])],1),e._v(" "),i("el-link",{attrs:{slot:"reference",underline:!1,icon:"el-icon-delete",type:"danger"},slot:"reference"},[e._v(e._s(e.$t("developer.delete")))])],1),e._v(" "),1==t.row.nodeType?i("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-s-unfold"},on:{click:function(i){e.deviceToChildren(t.row)}}},[e._v(e._s(e.$t("equipment.subdevice")))]):e._e(),e._v(" "),i("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-edit"},on:{click:function(i){e.editorDevice(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-link",{attrs:{type:"primary"},on:{click:function(i){e.goEdit(t.row)}}},[e._v("视图")])]}}])})],1),e._v(" "),i("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[i("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.devicelength,layout:"total, sizes, prev, pager, next, jumper",total:e.devicetotal},on:{"size-change":e.deviceSizeChange,"current-change":e.deviceCurrentChange}})],1)],1)]),e._v(" "),i("el-tab-pane",{attrs:{label:e.$t("equipment.batchmanagement"),name:"second"}},[i("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.pctableData}},[i("el-table-column",{attrs:{type:"index",label:e.$t("equipment.serialnumber"),align:"center",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.batchname"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.attributes.data.batch_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:e.$t("equipment.createdAt")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.utc2beijing(t.row.createdAt)))])]}}])})],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"设备"+e.equipmentEditor,visible:e.devicedialogVisible,width:"50%","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.devicedialogVisible=t}}},[i("div",{staticClass:"header-title",attrs:{slot:"title"},slot:"title"},[i("span",{staticClass:"title-name"},[e._v("\n         "+e._s("设备"+e.equipmentEditor)+"\n          "),i("el-tooltip",{staticStyle:{"margin-left":"5px"},attrs:{content:e.$t("equipment.text"),placement:"top"}},[i("i",{staticClass:"el-icon-question"})])],1)]),e._v(" "),i("div",{staticClass:"devicecontent"},[i("el-form",{ref:"deviceform",attrs:{model:e.deviceform,"label-width":"150px",rules:e.rules}},[i("el-form-item",{attrs:{label:e.$t("equipment.devicename"),prop:"name"}},[i("el-input",{model:{value:e.deviceform.name,callback:function(t){e.$set(e.deviceform,"name",t)},expression:"deviceform.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.devicenumber"),prop:"devaddr"}},[i("el-input",{model:{value:e.deviceform.devaddr,callback:function(t){e.$set(e.deviceform,"devaddr",t)},expression:"deviceform.devaddr"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.batchname"),prop:"batchId"}},[i("el-input",{attrs:{disabled:""},model:{value:e.deviceform.batchId,callback:function(t){e.$set(e.deviceform,"batchId",t)},expression:"deviceform.batchId"}},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"suffix"},on:{click:e.addDeviceBatch},slot:"suffix"})])],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("product.productname"),prop:"productName"}},[i("el-select",{attrs:{placeholder:e.$t("equipment.entername"),disabled:!e.productenable||!e.changeproduct},model:{value:e.deviceform.productName,callback:function(t){e.$set(e.deviceform,"productName",t)},expression:"deviceform.productName"}},e._l(e.proTableData1,function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.assetnumber")}},[i("el-input",{model:{value:e.deviceform.assetNum,callback:function(t){e.$set(e.deviceform,"assetNum",t)},expression:"deviceform.assetNum"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.equipmenttype")}},[i("el-input",{model:{value:e.deviceform.devModel,callback:function(t){e.$set(e.deviceform,"devModel",t)},expression:"deviceform.devModel"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.equipmentbrand")}},[i("el-input",{model:{value:e.deviceform.brand,callback:function(t){e.$set(e.deviceform,"brand",t)},expression:"deviceform.brand"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.installationlocation")}},[i("el-input",{on:{focus:e.updateLocation},model:{value:e.deviceform.address,callback:function(t){e.$set(e.deviceform,"address",t)},expression:"deviceform.address"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("developer.describe")}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4}},model:{value:e.deviceform.desc,callback:function(t){e.$set(e.deviceform,"desc",t)},expression:"deviceform.desc"}})],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("deviceform")}}},[e._v(e._s(e.$t("developer.determine")))]),e._v(" "),i("el-button",{on:{click:e.handleClose}},[e._v(e._s(e.$t("developer.cancel")))])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"批次添加",visible:e.pcdialogVisible,width:"50%","close-on-click-modal":!1,"before-close":e.handleClose1},on:{"update:visible":function(t){e.pcdialogVisible=t}}},[i("div",{staticClass:"pccontent"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.pcformInline}},[i("el-form-item",{attrs:{label:e.$t("equipment.batchname")}},[i("el-input",{attrs:{placeholder:e.$t("equipment.batchname")},model:{value:e.pcformInline.pcname,callback:function(t){e.$set(e.pcformInline,"pcname",t)},expression:"pcformInline.pcname"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("equipment.createdAt")}},[i("el-date-picker",{attrs:{type:"datetime"},model:{value:e.pcformInline.createdtime,callback:function(t){e.$set(e.pcformInline,"createdtime",t)},expression:"pcformInline.createdtime"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.addbatch}},[e._v(e._s(e.$t("equipment.addbatch")))])],1)],1),e._v(" "),i("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.pctableData,height:"450"}},[i("el-table-column",{attrs:{type:"index",label:e.$t("equipment.serialnumber"),align:"center",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("equipment.batchname"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.attributes.data.batch_name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:e.$t("equipment.createdAt")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e.utc2beijing(t.row.createdAt)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:e.$t("developer.operation"),align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.updatebatch(t.row,t.row.id)}}},[e._v(e._s(e.$t("developer.edit")))]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){e.deletebatch(t.row.id)}}},[e._v(e._s(e.$t("developer.delete")))]),e._v(" "),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(i){e.selectbatch(t.row,t.row.id)}}},[e._v("选择")])]}}])})],1)],1)]),e._v(" "),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:"设备安装地址",visible:e.bmapdialogVisible,width:"50%","close-on-click-modal":!1,"before-close":e.handleClosebmap},on:{"update:visible":function(t){e.bmapdialogVisible=t}}},[i("div",[i("el-form",{attrs:{model:e.bmapform,size:"small",inline:!0}},[i("el-form-item",{attrs:{label:"地址名称"}},[i("el-input",{model:{value:e.bmapform.keyword,callback:function(t){e.$set(e.bmapform,"keyword",t)},expression:"bmapform.keyword"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"选中地址"}},[i("el-input",{attrs:{readonly:""},model:{value:e.bmapform.address,callback:function(t){e.$set(e.bmapform,"address",t)},expression:"bmapform.address"}})],1)],1),e._v(" "),i("baidu-map",{staticStyle:{height:"300px"},attrs:{center:e.center,zoom:e.zoom,"scroll-wheel-zoom":!0,mapClick:!1},on:{ready:e.handler,click:e.mapClick}},[i("bm-local-search",{staticStyle:{display:"none"},attrs:{keyword:e.bmapform.keyword,"auto-viewport":!0,location:e.bmapform.location,zoom:"12.8"}}),e._v(" "),i("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),e._v(" "),i("bm-geolocation",{attrs:{anchor:"BMAP_ANCHOR_BOTTOM_RIGHT",showAddressBar:!0,autoLocation:!0}}),e._v(" "),i("bm-city-list",{attrs:{anchor:"BMAP_ANCHOR_TOP_LEFT"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.addressSure}},[e._v("保 存")]),e._v(" "),i("el-button",{on:{click:function(t){e.bmapdialogVisible=!1}}},[e._v("取 消")])],1)])],1)])},[],!1,null,"124a72e0",null);v.options.__file="index.vue";t.default=v.exports},"2Nb0":function(e,t,i){i("FlQf"),i("bBy9"),e.exports=i("zLkG").f("iterator")},"6/1s":function(e,t,i){var n=i("YqAc")("meta"),a=i("93I4"),s=i("B+OT"),o=i("2faE").f,r=0,c=Object.isExtensible||function(){return!0},l=!i("KUxP")(function(){return c(Object.preventExtensions({}))}),d=function(e){o(e,n,{value:{i:"O"+ ++r,w:{}}})},u=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!s(e,n)){if(!c(e))return"F";if(!t)return"E";d(e)}return e[n].i},getWeak:function(e,t){if(!s(e,n)){if(!c(e))return!0;if(!t)return!1;d(e)}return e[n].w},onFreeze:function(e){return l&&u.NEED&&c(e)&&!s(e,n)&&d(e),e}}},"7Qib":function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a});i("EJiy");function n(e,t,i){var n=void 0,a=void 0,s=void 0,o=void 0,r=void 0,c=function c(){var l=+new Date-o;l<t&&l>0?n=setTimeout(c,t-l):(n=null,i||(r=e.apply(s,a),n||(s=a=null)))};return function(){for(var a=arguments.length,l=Array(a),d=0;d<a;d++)l[d]=arguments[d];s=this,o=+new Date;var u=i&&!n;return n||(n=setTimeout(c,t)),u&&(r=e.apply(s,l),s=l=null),r}}function a(e){return new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")}},A5Xg:function(e,t,i){var n=i("NsO/"),a=i("ar/p").f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==s.call(e)?function(e){try{return a(e)}catch(e){return o.slice()}}(e):a(n(e))}},AUvm:function(e,t,i){"use strict";var n=i("5T2Y"),a=i("B+OT"),s=i("jmDH"),o=i("Y7ZC"),r=i("kTiW"),c=i("6/1s").KEY,l=i("KUxP"),d=i("29s/"),u=i("RfKB"),p=i("YqAc"),m=i("UWiX"),v=i("zLkG"),f=i("Zxgi"),b=i("R+7+"),h=i("kAMH"),g=i("5K7Z"),y=i("93I4"),_=i("NsO/"),w=i("G8Mo"),q=i("rr1i"),$=i("oVml"),k=i("A5Xg"),x=i("vwuL"),D=i("2faE"),T=i("w6GO"),O=x.f,S=D.f,C=k.f,j=n.Symbol,I=n.JSON,E=I&&I.stringify,N=m("_hidden"),M=m("toPrimitive"),A={}.propertyIsEnumerable,P=d("symbol-registry"),z=d("symbols"),V=d("op-symbols"),F=Object.prototype,B="function"==typeof j,L=n.QObject,R=!L||!L.prototype||!L.prototype.findChild,Q=s&&l(function(){return 7!=$(S({},"a",{get:function(){return S(this,"a",{value:7}).a}})).a})?function(e,t,i){var n=O(F,t);n&&delete F[t],S(e,t,i),n&&e!==F&&S(F,t,n)}:S,G=function(e){var t=z[e]=$(j.prototype);return t._k=e,t},H=B&&"symbol"==typeof j.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof j},K=function(e,t,i){return e===F&&K(V,t,i),g(e),t=w(t,!0),g(i),a(z,t)?(i.enumerable?(a(e,N)&&e[N][t]&&(e[N][t]=!1),i=$(i,{enumerable:q(0,!1)})):(a(e,N)||S(e,N,q(1,{})),e[N][t]=!0),Q(e,t,i)):S(e,t,i)},W=function(e,t){g(e);for(var i,n=b(t=_(t)),a=0,s=n.length;s>a;)K(e,i=n[a++],t[i]);return e},U=function(e){var t=A.call(this,e=w(e,!0));return!(this===F&&a(z,e)&&!a(V,e))&&(!(t||!a(this,e)||!a(z,e)||a(this,N)&&this[N][e])||t)},Y=function(e,t){if(e=_(e),t=w(t,!0),e!==F||!a(z,t)||a(V,t)){var i=O(e,t);return!i||!a(z,t)||a(e,N)&&e[N][t]||(i.enumerable=!0),i}},J=function(e){for(var t,i=C(_(e)),n=[],s=0;i.length>s;)a(z,t=i[s++])||t==N||t==c||n.push(t);return n},Z=function(e){for(var t,i=e===F,n=C(i?V:_(e)),s=[],o=0;n.length>o;)!a(z,t=n[o++])||i&&!a(F,t)||s.push(z[t]);return s};B||(r((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0),t=function(i){this===F&&t.call(V,i),a(this,N)&&a(this[N],e)&&(this[N][e]=!1),Q(this,e,q(1,i))};return s&&R&&Q(F,e,{configurable:!0,set:t}),G(e)}).prototype,"toString",function(){return this._k}),x.f=Y,D.f=K,i("ar/p").f=k.f=J,i("NV0k").f=U,i("mqlF").f=Z,s&&!i("uOPS")&&r(F,"propertyIsEnumerable",U,!0),v.f=function(e){return G(m(e))}),o(o.G+o.W+o.F*!B,{Symbol:j});for(var X="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;X.length>ee;)m(X[ee++]);for(var te=T(m.store),ie=0;te.length>ie;)f(te[ie++]);o(o.S+o.F*!B,"Symbol",{for:function(e){return a(P,e+="")?P[e]:P[e]=j(e)},keyFor:function(e){if(!H(e))throw TypeError(e+" is not a symbol!");for(var t in P)if(P[t]===e)return t},useSetter:function(){R=!0},useSimple:function(){R=!1}}),o(o.S+o.F*!B,"Object",{create:function(e,t){return void 0===t?$(e):W($(e),t)},defineProperty:K,defineProperties:W,getOwnPropertyDescriptor:Y,getOwnPropertyNames:J,getOwnPropertySymbols:Z}),I&&o(o.S+o.F*(!B||l(function(){var e=j();return"[null]"!=E([e])||"{}"!=E({a:e})||"{}"!=E(Object(e))})),"JSON",{stringify:function(e){for(var t,i,n=[e],a=1;arguments.length>a;)n.push(arguments[a++]);if(i=t=n[1],(y(t)||void 0!==e)&&!H(e))return h(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!H(t))return t}),n[1]=t,E.apply(I,n)}}),j.prototype[M]||i("NegM")(j.prototype,M,j.prototype.valueOf),u(j,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},EJiy:function(e,t,i){"use strict";t.__esModule=!0;var n=o(i("F+2o")),a=o(i("+JPL")),s="function"==typeof a.default&&"symbol"==typeof n.default?function(e){return typeof e}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof a.default&&"symbol"===s(n.default)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":void 0===e?"undefined":s(e)}},"F+2o":function(e,t,i){e.exports={default:i("2Nb0"),__esModule:!0}},GoGi:function(e,t,i){"use strict";var n=i("Z4DD");i.n(n).a},KMe2:function(e,t,i){},MPjy:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("X3IP");function a(e){"209"==e.code?(Object(n.Message)({message:"您权限过期,请重新登录",type:"error",duration:2e3}),sessionStorage.removeItem("roles"),sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("list"),location.href="/#/login"):119==e.code?Object(n.Message)({message:"没有操作权限",type:"warning",duration:2e3}):Object(n.Message)({message:e.message,type:"error"})}},"R+7+":function(e,t,i){var n=i("w6GO"),a=i("mqlF"),s=i("NV0k");e.exports=function(e){var t=n(e),i=a.f;if(i)for(var o,r=i(e),c=s.f,l=0;r.length>l;)c.call(e,o=r[l++])&&t.push(o);return t}},SKMb:function(e,t,i){"use strict";var n=i("KMe2");i.n(n).a},XINx:function(e,t,i){"use strict";var n={bind:function(e,t,i){var n=e.querySelector(".el-dialog__header"),a=e.querySelector(".el-dialog");n.style.cssText+=";cursor:move;",a.style.cssText+=";top:0px;";var s=window.document.currentStyle?function(e,t){return e.currentStyle[t]}:function(e,t){return getComputedStyle(e,!1)[t]};n.onmousedown=function(e){var t=e.clientX-n.offsetLeft,i=e.clientY-n.offsetTop,o=a.offsetWidth,r=a.offsetHeight,c=document.body.clientWidth,l=document.body.clientHeight,d=a.offsetLeft,u=c-a.offsetLeft-o,p=a.offsetTop,m=l-a.offsetTop-r,v=s(a,"left"),f=s(a,"top");v.includes("%")?(v=+document.body.clientWidth*(+v.replace(/\%/g,"")/100),f=+document.body.clientHeight*(+f.replace(/\%/g,"")/100)):(v=+v.replace(/\px/g,""),f=+f.replace(/\px/g,"")),document.onmousemove=function(e){var n=e.clientX-t,s=e.clientY-i;-n>d?n=-d:n>u&&(n=u),-s>p?s=-p:s>m&&(s=m),a.style.cssText+=";left:"+(n+v)+"px;top:"+(s+f)+"px;"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}},a=function(e){e.directive("el-drag-dialog",n)};window.Vue&&(window["el-drag-dialog"]=n,Vue.use(a)),n.install=a;t.a=n},Z4DD:function(e,t,i){},Zxgi:function(e,t,i){var n=i("5T2Y"),a=i("WEpk"),s=i("uOPS"),o=i("zLkG"),r=i("2faE").f;e.exports=function(e){var t=a.Symbol||(a.Symbol=s?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||r(t,e,{value:o.f(e)})}},adOz:function(e,t,i){i("Zxgi")("asyncIterator")},"ar/p":function(e,t,i){var n=i("5vMV"),a=i("FpHa").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,a)}},dl0q:function(e,t,i){i("Zxgi")("observable")},kAMH:function(e,t,i){var n=i("a0xu");e.exports=Array.isArray||function(e){return"Array"==n(e)}},vwuL:function(e,t,i){var n=i("NV0k"),a=i("rr1i"),s=i("NsO/"),o=i("G8Mo"),r=i("B+OT"),c=i("eUtF"),l=Object.getOwnPropertyDescriptor;t.f=i("jmDH")?l:function(e,t){if(e=s(e),t=o(t,!0),c)try{return l(e,t)}catch(e){}if(r(e,t))return a(!n.f.call(e,t),e[t])}},zLkG:function(e,t,i){t.f=i("UWiX")}}]);