(this.webpackJsonp=this.webpackJsonp||[]).push([["chunk-4687"],{"35y/":function(e,t,a){},B4Ll:function(e,t,a){"use strict";a.r(t);var i=a("4d7F"),r=a.n(i),s=a("YEIV"),n=a.n(s),o=a("v0iw"),l=a.n(o),c=a("XXUv"),d=a("MPjy"),u={components:{Pumpdepartment:c.a},data:function(){return n()({deviceForm:{name:""},disposeVisible:!1,alldevice:[],updatedId:"",checkdevice:[],formLabelWidth:"120px",dialogVisible:!1,departmentid:"",formInline:{laboratory:"",testbed:"",name:""},properties:[{name:"效率",dataType:{type:"float",specs:{max:100,min:0,step:.1,unit:"%"}},required:!0,accessMode:"r",identifier:"effect"},{name:"转速",dataType:{type:"int",specs:{max:1e4,min:0,step:.2,unit:"r/min"}},required:!0,accessMode:"r",identifier:"speed"},{name:"扬程",dataType:{type:"float",specs:{max:1e3,min:0,step:.1,unit:"m"}},required:!0,accessMode:"r",identifier:"head"},{name:"出口压力",dataType:{type:"float",specs:{max:1e4,min:0,step:.1,unit:"Mpa"}},required:!0,accessMode:"r",identifier:"pressure_out"},{name:"进口压力",dataType:{type:"float",specs:{max:1e4,min:0,step:.1,unit:"Mpa"}},required:!0,accessMode:"r",identifier:"pressure_in"},{name:"功率因数",dataType:{type:"float",specs:{max:1,min:0,step:.1,unit:""}},required:!0,accessMode:"r",identifier:"power_factor"},{name:"功率",dataType:{type:"float",specs:{max:1e4,min:0,step:.1,unit:"kW"}},required:!0,accessMode:"r",identifier:"power"},{name:"电压",dataType:{type:"float",specs:{max:380,min:0,step:.1,unit:"V"}},required:!0,accessMode:"r",identifier:"vol"},{name:"电流",dataType:{type:"float",specs:{max:1e3,min:0,step:.1,unit:"A"}},required:!0,accessMode:"r",identifier:"current"},{name:"流量",dataType:{type:"float",specs:{max:1e4,min:0,step:.1,unit:"m³/h"}},required:!0,accessMode:"r",identifier:"flow"},{name:"温度",dataType:{type:"float",specs:{max:1e3,min:-100,step:1,unit:"°C"}},required:!0,accessMode:"r",identifier:"temperature"}],formrules:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],devaddr:[{required:!0,message:"请输入设备编号",trigger:"blur"}],factory:[{required:!0,message:"请输入设备生产厂家",trigger:"blur"}],product:[{required:!0,message:"请选择设备所属产品",trigger:"change"}],laboratory:[{required:!0,message:"请选择设备所属实验室",trigger:"change"}],testbed:[{required:!0,message:"请选择设备所属测试台体",trigger:"change"}],target:[{required:!0,message:"请选择仪器检测指标",trigger:"change"}],region:[{required:!0,message:"请选择活动区域",trigger:"change"}]},devicesid:"",laboratoryname:"",testbedname:"",tableData:[],multipleSelection:[],pagesize:10,start:0,total:0,form:{name:"",region:"",imgsrc:"",laboratory:"",product:"",testbed:"",factory:"",devaddr:"",devmodel:"",agreement:"",target:"",desc:""},departmentlaboratory:[],testbedlist:[],productlist:[]},"departmentid","")},mounted:function(){this.getDevices(),this.getDepartmentLaboratory(),this.getProductList(),this.getAllBed()},methods:{getAllBed:function(){var e=this,t=l.a.Object.extend("Testbed"),a=new l.a.Query(t);a.limit(1e3),a.find().then(function(t){e.alltestbed=t},function(e){Object(d.a)(e)})},getDevices:function(e,t){var a=this;0==e&&(this.start=0);var i=l.a.Object.extend("Devices"),r=new l.a.Query(i);r.equalTo("basedata.type","PUMP"),""!=this.formInline.laboratory&&r.equalTo("basedata.laboratoryid",this.formInline.laboratory),""!=this.formInline.testbed&&r.matches("basedata.testbedname",this.formInline.testbed,"i"),""!=this.formInline.name&&r.matches("name",this.formInline.name,"i"),t&&r.equalTo("basedata.laboratoryid",t),r.limit(this.pagesize),r.skip(this.start),r.count().then(function(e){a.total=e,r.find().then(function(e){a.tableData=e},function(e){Object(d.a)(e)})},function(e){Object(d.a)(e)})},resetFormInline:function(){this.formInline={laboratory:"",testbed:"",name:""}},getPumpNode:function(e){this.departmentid=e.objectId,console.log(e),"实验室"==e.icon&&(this.formInline.laboratory=e.objectId,this.getDevices(0,this.departmentid))},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.start=(e-1)*this.pagesize},getProductList:function(){var e=this,t=l.a.Object.extend("Product");new l.a.Query(t).find().then(function(t){e.productlist=t},function(e){Object(d.a)(e)})},getDepartmentLaboratory:function(){var e=this,t=l.a.Object.extend("Department"),a=new l.a.Query(t);a.equalTo("org_type","实验室"),a.find().then(function(t){e.departmentlaboratory=t},function(e){Object(d.a)(e)})},departmentChange:function(e){var t=this;this.departmentlaboratory.map(function(a){a.id==e&&(t.laboratoryname=a.attributes.name)});var a=l.a.Object.extend("Testbed"),i=new l.a.Query(a);i.equalTo("department",e),i.find().then(function(e){t.testbedlist=e},function(e){Object(d.a)(e)})},testBedName:function(e){var t=this;this.testbedlist.map(function(a){e==a.id&&(t.testbedname=a.attributes.name)})},adddevices:function(){this.dialogVisible=!0},fixDevices:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return t.$message.error("有必填项未填写"),!1;var i=l.a.User.current().id,r=new(l.a.Object.extend("Devices")),s=new(l.a.Object.extend("Product")),n=new l.a.ACL;s.id=t.form.product,""!=t.devicesid&&(r.id=t.devicesid),n.setReadAccess(i,!0),n.setWriteAccess(i,!0),r.set("ACL",n),r.set("name",t.form.name),r.set("devaddr",t.form.devaddr),r.set("devModel",t.form.devmodel),r.set("desc",t.form.desc),r.set("product",s),r.set("basedata",{laboratoryid:t.form.laboratory,laboratory:t.laboratoryname,agreement:t.form.agreement,imgsrc:t.form.imgsrc,factory:t.form.factory,testbed:t.form.testbed,target:t.form.target,testbedname:t.testbedname,type:"PUMP"}),r.save().then(function(a){if(a){console.log(a),t.devicesid="";var i=new(l.a.Object.extend("Testbed")),r=new(l.a.Object.extend("Devices"));i.id=t.form.testbed;var s=i.relation("devices");r.set("objectId",a.id),s.add(r),r.save().then(function(a){a&&(t.$message.success("创建成功"),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getDevices())})}})})},beforeAvatarUpload1:function(e){var t=e.name.substring(e.name.lastIndexOf(".")+1),a="jpg"===t||"JPG"===t||"png"===t||"PNG"===t||"bpm"===t||"BPM"===t,i=e.size/1024/1024<10;return a?(console.log(e),i?a||i:(this.$message({message:"上传文件大小不能超过 10MB!",type:"error"}),!1)):(this.$message({message:"上传图片只能是jpg / png / bpm格式!",type:"error"}),!1)},handleAvatarSuccessBusiness1:function(e,t,a){this.form.imgsrc=e.path,this.$message.success("上传成功")},deleteDevices:function(){var e=this,t=[];0!=this.multipleSelection.length?this.$confirm("此操作将永久删除选中检测设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.multipleSelection.map(function(a){t.push(new r.a(function(e,t){var i=new(l.a.Object.extend("Devices"));return i.id=a.id,i.destroy().then(function(t){e(t)},function(e){t(e.message)})})),r.a.all(t).then(function(t){e.$message({message:"删除成功",type:"success"}),t.length==e.multipleSelection.length&&e.getDevices()}).catch(function(t){e.$message({message:t,type:"error"})})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message.warning("请勾选要删除的检测设备")},editorDevice:function(e){var t=this;this.devicesid=e,this.dialogVisible=!0;var a=l.a.Object.extend("Devices");new l.a.Query(a).get(e).then(function(e){t.form.name=e.attributes.name,t.form.laboratory=e.attributes.basedata.laboratoryid,t.departmentChange(e.attributes.basedata.laboratoryid),t.form.product=e.attributes.product.id,t.form.devaddr=e.attributes.devaddr,t.form.desc=e.attributes.desc,t.form.devmodel=e.attributes.devModel,t.form.testbed=e.attributes.basedata.testbed,t.testBedName(e.attributes.basedata.testbed),t.form.agreement=e.attributes.basedata.agreement,t.form.factory=e.attributes.basedata.factory,t.form.target=e.attributes.basedata.target,t.form.imgsrc=e.attributes.basedata.imgsrc},function(e){Object(d.a)(e)})},deleteDevice:function(e){var t=this;this.$confirm("此操作将永久删除该检测设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=new(l.a.Object.extend("Devices"));a.id=e,a.destroy().then(function(e){t.$message({message:"删除成功",type:"success"}),t.getDevices()},function(e){Object(d.a)(eror)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},relationDevice:function(e){this.alldevice=[],this.alldevice.push(e),this.checkdevice.push(e.id),this.disposeVisible=!0,this.updatedId=e.attributes.basedata.testbed},clearTestbed:function(){this.updatedId=""},addTestRelation:function(){var e,t=this;if(e=this.alldevice[0].attributes.basedata,""!=this.updatedId){var a=l.a.Object.extend("Testbed");new l.a.Query(a).get(this.updatedId).then(function(a){var i=new(l.a.Object.extend("Devices"));i.id=t.checkdevice[0],i.set("basedata",{laboratoryid:a.attributes.department.id,laboratory:a.attributes.department.attributes.name,agreement:e.agreement,imgsrc:e.imgsrc,factory:e.factory,testbed:t.updatedId,target:e.target,testbedname:a.attributes.name,type:"PUMP"}),i.save().then(function(e){if(e){var a=new(l.a.Object.extend("Testbed")),i=new(l.a.Object.extend("Devices"));a.id=t.alldevice[0].attributes.basedata.testbed;var r=a.relation("devices");i.set("objectId",t.alldevice[0].id),r.remove(i),a.save().then(function(e){var i=new(l.a.Object.extend("Testbed")),r=new(l.a.Object.extend("Devices"));i.id=t.updatedId;var s=a.relation("devices");r.set("objectId",t.updatedId),s.add(r),i.save().then(function(a){e&&(t.$message.success("关联成功"),t.disposeVisible=!1,t.getDevices())})})}})})}}}},m=(a("W5CC"),a("FVAc"),a("KHd+")),f=Object(m.a)(u,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checkdevies"},[a("Pumpdepartment",{staticStyle:{width:"360px",height:"100vh",overflow:"scroll","flex-shrink":"0",padding:"10px"},on:{pumpDetail:e.getPumpNode}}),e._v(" "),a("div",{staticClass:"devicesright",staticStyle:{width:"calc(100% - 360px)",padding:"20px"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"所属实验室"}},[a("el-select",{attrs:{placeholder:"所属实验室"},model:{value:e.formInline.laboratory,callback:function(t){e.$set(e.formInline,"laboratory",t)},expression:"formInline.laboratory"}},e._l(e.departmentlaboratory,function(e,t){return a("el-option",{key:t,attrs:{label:e.attributes.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"检测台"}},[a("el-input",{attrs:{placeholder:"请输入检测台名称"},model:{value:e.formInline.testbed,callback:function(t){e.$set(e.formInline,"testbed",t)},expression:"formInline.testbed"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"传感器"}},[a("el-input",{attrs:{placeholder:"请输入传感器名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.getDevices(0)}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.resetFormInline}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"adddevices"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.adddevices}},[e._v("新增传感器")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.deleteDevices}},[e._v("删除")])],1),e._v(" "),a("div",{staticClass:"tableblock"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"检测仪器名称",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.attributes.name))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属实验室",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.basedata.laboratory))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属产品",width:"200",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.product.attributes.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"测量指标",width:"200",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"检测仪器编号",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.devaddr))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"协议指标",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.basedata.agreement))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"生产厂家",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.basedata.factory))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"仪器型号",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.devModel))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"备注",width:"200",align:"center","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.attributes.desc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"检测仪器管理",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:function(a){e.editorDevice(t.row.id)}}}),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(a){e.deleteDevice(t.row.id)}}}),e._v(" "),a("el-button",{attrs:{type:"success",icon:"el-icon-s-operation",size:"small"},on:{click:function(a){e.relationDevice(t.row)}}})]}}])})],1)],1),e._v(" "),a("div",{staticClass:"pageblock"},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"检测仪器新增",visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"addContent"},[a("el-form",{ref:"devform",attrs:{model:e.form,rules:e.formrules}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"检测仪器名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入检测仪器名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属产品","label-width":e.formLabelWidth,prop:"product"}},[a("el-select",{attrs:{placeholder:"请选择产品"},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e.productlist,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.attributes.name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"检测仪器编号","label-width":e.formLabelWidth,prop:"devaddr"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入检测仪器编号"},model:{value:e.form.devaddr,callback:function(t){e.$set(e.form,"devaddr",t)},expression:"form.devaddr"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"生产厂家","label-width":e.formLabelWidth,prop:"factory"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备生产厂家信息"},model:{value:e.form.factory,callback:function(t){e.$set(e.form,"factory",t)},expression:"form.factory"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"实验仪器图片","label-width":e.formLabelWidth,required:""}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ci.iotn2n.com:5080/iotapi/upload","show-file-list":!1,"on-success":e.handleAvatarSuccessBusiness1,"before-upload":e.beforeAvatarUpload1}},[e.form.imgsrc?a("img",{staticClass:"avatar",attrs:{src:e.form.imgsrc}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{width:"300px",height:"200px"}})]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.imgsrc,expression:"form.imgsrc!=''"}],staticStyle:{position:"absolute",left:"200px",top:"150px","margin-left":"0"},attrs:{size:"small",type:"danger"},on:{click:function(t){e.form.imgsrc=""}}},[e._v("删除")])],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属测试台","label-width":e.formLabelWidth}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"laboratory"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择实验室"},on:{change:e.departmentChange},model:{value:e.form.laboratory,callback:function(t){e.$set(e.form,"laboratory",t)},expression:"form.laboratory"}},e._l(e.departmentlaboratory,function(e,t){return a("el-option",{key:t,attrs:{label:e.attributes.name,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"testbed"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择测试台体"},on:{change:e.testBedName},model:{value:e.form.testbed,callback:function(t){e.$set(e.form,"testbed",t)},expression:"form.testbed"}},e._l(e.testbedlist,function(e,t){return a("el-option",{key:t,attrs:{value:e.id,label:e.attributes.name}})}))],1)],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"仪器测量指标","label-width":e.formLabelWidth,prop:"target"}},[a("el-select",{attrs:{placeholder:"请选择仪器测量指标"},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},e._l(e.properties,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.identifier}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"仪器协议类型","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入仪器协议类型(如：Modbus、自定义协议类型)"},model:{value:e.form.agreement,callback:function(t){e.$set(e.form,"agreement",t)},expression:"form.agreement"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"检测仪器型号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入检测仪器型号"},model:{value:e.form.devmodel,callback:function(t){e.$set(e.form,"devmodel",t)},expression:"form.devmodel"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入检测仪器备注信息"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.fixDevices("devform")}}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"仪器关联",visible:e.disposeVisible,width:"50%"},on:{"update:visible":function(t){e.disposeVisible=t}}},[a("div",{staticClass:"dispose",staticStyle:{display:"flex"}},[a("el-card",{staticClass:"box-card",staticStyle:{width:"45%",height:"300px","overflow-y":"scroll"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("实验仪器")])]),e._v(" "),a("el-checkbox-group",{model:{value:e.checkdevice,callback:function(t){e.checkdevice=t},expression:"checkdevice"}},e._l(e.alldevice,function(t,i){return a("el-checkbox",{key:i,staticStyle:{display:"block"},attrs:{label:t.id,disabled:""}},[e._v(e._s(t.attributes.name))])}))],1),e._v(" "),a("div",{staticStyle:{margin:"0 20px","text-align":"center"}},[a("span",{staticClass:"svg-container",staticStyle:{"line-height":"300px"}},[a("svg-icon",{staticStyle:{width:"3rem",height:"3rem"},attrs:{"icon-class":"relation"}})],1)]),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{width:"45%",height:"300px","overflow-y":"scroll"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("测试台体")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.clearTestbed}},[e._v("清空")])],1),e._v(" "),e._l(e.alltestbed,function(t,i){return a("div",{key:i,staticClass:"text item"},[a("el-radio",{staticStyle:{height:"20px"},attrs:{label:t.id},model:{value:e.updatedId,callback:function(t){e.updatedId=t},expression:"updatedId"}},[e._v(e._s(t.attributes.name))])],1)})],2)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.disposeVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addTestRelation}},[e._v("确 定")])],1)])],1)},[],!1,null,"51d7107e",null);f.options.__file="check_devices.vue";t.default=f.exports},FVAc:function(e,t,a){"use strict";var i=a("pdVF");a.n(i).a},MPjy:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var i=a("X3IP");function r(e){"209"==e.code?(Object(i.Message)({message:"您权限过期,请重新登录",type:"error",duration:2e3}),sessionStorage.removeItem("roles"),sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("list"),location.href="/#/login"):119==e.code?Object(i.Message)({message:"没有操作权限",type:"warning",duration:2e3}):Object(i.Message)({message:e.message,type:"error"})}},NJDy:function(e,t,a){},"RU/L":function(e,t,a){a("Rqdy");var i=a("WEpk").Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var i=a("Y7ZC");i(i.S+i.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},W5CC:function(e,t,a){"use strict";var i=a("NJDy");a.n(i).a},XXUv:function(e,t,a){"use strict";var i=a("gDS+"),r=a.n(i),s=a("YEIV"),n=a.n(s),o=a("v0iw"),l=a.n(o),c=(a("72z0"),{name:"Pumpdepartment",props:["regiondata"],data:function(){var e;return e={search:"",defaultProps:{isLeaf:"leaf",children:"children",label:"name"},data:[],node:[],treeData1:[],data1:[]},n()(e,"node",[]),n()(e,"resolve",[]),e},watch:{},computed:{treeData:function(){var e=JSON.parse(r()(this.data1));return e.filter(function(t){var a=e.filter(function(e){return t.objectId==e.ParentId});return a.length>0&&(t.children=a),0==t.ParentId})}},mounted:function(){console.log(this.data1)},methods:{reset:function(){this.search=""},handleNodeClick:function(e){this.$emit("pumpDetail",e)},getOrgList:function(e,t){var a=this;if(0===e.level){this.data=[];var i=l.a.Object.extend("Department");(r=new l.a.Query(i)).equalTo("ParentId","0"),r.find().then(function(e){return e.map(function(e){var t={};e.createtime=new Date(e.attributes.createdAt).toLocaleDateString(),t.name=e.attributes.name,t.ParentId=e.attributes.ParentId,t.objectId=e.id,t.level=e.attributes.level,t.createtime=e.createtime,t.leaf=e.attributes.leafnode,t.icon=e.attributes.org_type,t.isvcon=!1,a.data.push(t),a.data1.push(t)}),t(a.data)},function(e){t([]),"209"==e.code?(a.$message({type:"warning",message:"登陆权限过期，请重新登录"}),a.$router.push({path:"/login"})):119==e.code&&a.$message({type:"error",message:"没有操作权限"})})}else if(0!==e.level&&"实验台"!==e.data.icon&&0==e.data.isvcon){this.data=[];var r;i=l.a.Object.extend("Department");(r=new l.a.Query(i)).equalTo("ParentId",e.data.objectId),r.ascending("org_type"),r.limit(1e4),r.find().then(function(e){return e.map(function(e){var t={};e.createtime=new Date(e.attributes.createdAt).toLocaleDateString(),t.name=e.attributes.name,t.ParentId=e.attributes.ParentId,t.objectId=e.id,t.level=e.attributes.level,t.createtime=e.createtime,1==e.attributes.leafnode?t.isvcon=!0:t.isvcon=!1,t.leaf=e.attributes.leafnode,t.icon=e.attributes.org_type,a.data.push(t),a.data1.push(t)}),t(a.data)},function(e){t([]),"209"==e.code?(a.$message({type:"warning",message:"登陆权限过期，请重新登录"}),a.$router.push({path:"/login"})):119==e.code&&a.$message({type:"error",message:"没有操作权限"})})}}}}),d=(a("zbzu"),a("KHd+")),u=Object(d.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource1",staticStyle:{"border-left":"38px solid #1579bf","padding-left":"10px"}},[a("div",[a("el-input",{staticStyle:{width:"150px"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),a("el-tree",{ref:"tree",staticStyle:{"margin-top":"20px"},attrs:{props:e.defaultProps,"expand-on-click-node":!1,"highlight-current":!0,lazy:"",load:e.getOrgList,"node-key":"objectId"},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,r=t.data;return a("span",{},["质检中心"==r.icon?a("svg-icon",{staticStyle:{width:"20px",height:"20px"},attrs:{"icon-class":"质检中心"}}):"泵单位"==r.icon?a("svg-icon",{staticStyle:{width:"20px",height:"20px"},attrs:{"icon-class":"水泵企业"}}):"实验室"==r.icon?a("svg-icon",{staticStyle:{width:"20px",height:"20px"},attrs:{"icon-class":"实验室"}}):e._e(),e._v(" "),a("span",{staticStyle:{"padding-left":"4px"}},[e._v(e._s(i.label))])],1)}}])})],1)])},[],!1,null,null,null);u.options.__file="pumpdepartment.vue";t.a=u.exports},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(a("SEkw"));t.default=function(e,t,a){return t in e?(0,i.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},pdVF:function(e,t,a){},zbzu:function(e,t,a){"use strict";var i=a("35y/");a.n(i).a}}]);