(this.webpackJsonp=this.webpackJsonp||[]).push([["chunk-d65c"],{EkTO:function(t,e,a){"use strict";var s=a("sjY2");a.n(s).a},Jedr:function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"e",function(){return l}),a.d(e,"f",function(){return o}),a.d(e,"d",function(){return u});var s=a("t3Un");function i(t,e,a,i,n){return Object(s.a)({url:"/shuwa_task/historyVcaddr",method:"get",params:{node:null,start:t,length:e,di:a,datetime:i,"search[value]":n}})}function n(){return Object(s.a)({url:"/shuwa_task/diList",method:"get"})}function r(t,e,a,i){return Object(s.a)({url:"shuwa_task/historyMeter",method:"get",params:{node:t,di:e,datetime:a,vcaddr:i}})}function l(t,e,a,i,n,r,l){return Object(s.a)({url:"/shuwa_task/vcaddr",method:"get",params:{start:t,length:e,tid:a,rid:i,starttime:n,freq:r,search:l}})}function o(t,e,a,i,n,r,l){return Object(s.a)({url:"shuwa_task/meter",method:"get",params:{tid:t,rid:e,starttime:a,vcaddr:i,freq:n,fdate:r,di:l}})}function u(t){return Object(s.a)({url:"/shuwa_task/readMeter",method:"post",data:{datetime:t.datetime,di:t.di,pn:t.pn,taskid:t.taskid,vcaddr:t.vcaddr,tattr:t.tattr}})}},eQ2b:function(t,e,a){"use strict";a.r(e);var s=a("Jedr"),i=(a("fe1z"),{data:function(){var t=this;return{dis:[],downchannel:[],taskstarttime:"",id:"",node:null,draw:1,start:0,length:10,contotal:0,consuccess:0,consuc:0,tableData:[],total:0,formline:{name:"",searchvalue:"",starttime:"",chs:1,value1:""},timeselect:[],freq:"",unit:"",loading:!0,loadingtext:"加载中",pickerOptions:{disabledDate:function(e){var a=1e3*t.taskstarttime;return a?e.getTime()<new Date(a).getTime()-864e5||e.getTime()>Date.now():e.getTime()<Date.now()-864e5}},freqstep:"",origintime:[],frozendate:""}},mounted:function(){this.originData()},methods:{timestampToTime:function(t){var e=new Date(1e3*t);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+((e.getDate()+1<=10?"0"+e.getDate():e.getDate())+" ")+((e.getHours()+1<=10?"0"+e.getHours():e.getHours())+":")+((e.getMinutes()+1<=10?"0"+e.getMinutes():e.getMinutes())+":")+(e.getSeconds()+1<=10?"0"+e.getSeconds():e.getSeconds())},originData:function(){var t=this;if(this.id=this.$route.query.id,this.loading=!0,this.taskstarttime=this.$route.query.starttime,this.downchannel=JSON.parse(this.$route.query.downchannel),this.formline.name=this.$route.query.name,this.dis=JSON.parse(this.$route.query.di),0==this.$route.query.frozendate?this.frozendate=Number(new Date(new Date((new Date).toLocaleDateString()).getTime()))/1e3:this.frozendate=this.$route.query.frozendate,this.downchannel.length>=1&&this.downchannel.map(function(t){1==t[0]?t[0]="物理集中器":2==t[0]?t[0]="GPRS":3==t[0]?t[0]="LoRa":t[0]="NB"}),this.unit=this.$route.query.unit,"minute"==this.unit?this.freq=60*Number(this.$route.query.freq):"hour"==this.unit?this.freq=3600*Number(this.$route.query.freq):"day"==this.unit?this.freq=3600*Number(this.$route.query.freq)*24:"month"==this.unit&&(this.freq=3600*Number(this.$route.query.freq)*24*30),this.freqstep=Math.ceil((Number(parseInt(new Date/1e3))-this.taskstarttime)/this.freq),this.freqstep<=0)this.loadingtext="任务尚未开始",setTimeout(function(){t.loading=!1},3e3);else{this.origintime=[];for(var e=0;e<=this.freqstep-1;e++){var a=Number(this.taskstarttime)+Number(this.freq*e);this.origintime.push(a)}var s=new Date;s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),this.formline.value1=Date.parse(s),console.log(this.formline.value1),this.changeTime(),this.Gettaskdetail()}},changeTime:function(){var t=this,e=this.timestampToTime(this.formline.value1/1e3).substr(0,10);this.timeselect=[],this.origintime.map(function(a){-1!=t.timestampToTime(a).indexOf(e)&&t.timeselect.push(a)}),this.formline.starttime=this.timeselect[0]},Gettaskdetail:function(){var t=this;Object(s.e)(this.start,this.length,this.id,this.formline.chs,this.formline.starttime,this.freq,this.formline.searchvalue).then(function(e){e&&(t.tableData=e.data,t.total=e.recordsTotal,t.contotal=e.all,t.consuccess=e.success,t.consuc=e.success_rate.toFixed(2),t.loading=!1)}).catch(function(e){t.$message.error(e.error)})},handleSizeChange:function(t){this.length=t,this.Gettaskdetail()},handleCurrentChange:function(t){this.start=(t-1)*this.length,this.Gettaskdetail()},Meterdetail:function(t){this.$router.push({path:"/tasksmanage/taskmeterdetail",query:{tid:this.id,rid:this.formline.chs,starttime:this.formline.starttime,freq:this.freq,di:this.dis.join(","),fdate:this.frozendate,vcaddr:t}})}}}),n=(a("EkTO"),a("KHd+")),r=Object(n.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"taskschedule"},[a("div",{staticClass:"top"},[a("div",{staticClass:"left"},[a("span",[t._v("集中器个数")]),t._v(" "),a("p",[a("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.total))])],1)]),t._v(" "),a("div",{staticClass:"seconds"},[a("span",[t._v("电表总数")]),t._v(" "),a("p",[a("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.contotal))])],1)]),t._v(" "),a("div",{staticClass:"right"},[a("span",[t._v("成功sum")]),t._v(" "),a("p",[a("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.consuccess))])],1)]),t._v(" "),a("div",{staticClass:"right"},[a("span",[t._v("抄表成功率avg")]),t._v(" "),a("p",[a("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.consuc)+"%")])],1)])]),t._v(" "),a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formline,type:"small"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{attrs:{placeholder:"任务名称",readonly:""},model:{value:t.formline.name,callback:function(e){t.$set(t.formline,"name",e)},expression:"formline.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"查询日期"}},[a("el-date-picker",{attrs:{type:"date","picker-options":t.pickerOptions,placeholder:"选择日期"},on:{change:t.changeTime},model:{value:t.formline.value1,callback:function(e){t.$set(t.formline,"value1",e)},expression:"formline.value1"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"查询时间"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:t.formline.starttime,callback:function(e){t.$set(t.formline,"starttime",e)},expression:"formline.starttime"}},t._l(t.timeselect,function(e,s){return a("el-option",{key:s,attrs:{label:t.timestampToTime(Number(e)).substr(10),value:Number(e)}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"采集轮次"}},[a("el-select",{model:{value:t.formline.chs,callback:function(e){t.$set(t.formline,"chs",e)},expression:"formline.chs"}},t._l(t.downchannel,function(t,e){return a("el-option",{key:e,attrs:{label:"第"+(e+1)+"轮次("+t[0]+")",value:e+1}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"集中器地址"}},[a("el-input",{attrs:{placeholder:"集中器地址"},model:{value:t.formline.searchvalue,callback:function(e){t.$set(t.formline,"searchvalue",e)},expression:"formline.searchvalue"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.Gettaskdetail}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{type:"index",width:"100",index:function(e){return e+1+t.start}}}),t._v(" "),a("el-table-column",{attrs:{prop:"vcaddr",label:"集中器",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"冻结日期",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.timestampToTime(t.frozendate)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"数据项标识",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t.dis.join(",")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"抄表成功率",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.rate.toFixed(2)+"%"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.Meterdetail(e.row.vcaddr)}}},[t._v("详情")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"","page-sizes":[10,25,50,100],"page-size":t.length,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])},[],!1,null,"2aeaab2c",null);r.options.__file="taskschedule.vue";e.default=r.exports},sjY2:function(t,e,a){}}]);